# OpenVAS - Vulnerability Scanning

OpenVAS (Open Vulnerability Assessment System) is a publicly available vulnerability scanner developed by Greenbone Networks. Below is a summary of the essential steps to get started with OpenVAS.

---

## Overview

OpenVAS is part of the Greenbone Vulnerability Manager, which is also open source and free to use. OpenVAS provides capabilities for network scans, including both authenticated and unauthenticated testing.

---

## Installation Instructions for Parrot Security

### Installing Packages

Start by updating your system and installing the necessary packages:

```bash
sudo apt-get update && apt-get -y full-upgrade
sudo apt-get install gvm && openvas
```

### Configuration

Run the following command to initiate the installation and setup process:

```bash
gvm-setup
```

> **Note:** This process may take up to 30 minutes to complete.

### Starting OpenVAS

Once the setup is complete, start OpenVAS with the following command:

```bash
gvm-start
```

---

## Accessing the Web Interface

If you are using the pre-configured VM provided in the OpenVAS Skills Assessment section:

- URL: [https://<IP>:8080](https://<IP>:8080)
- **Credentials:**
  - Username: `htb-student`
  - Password: `HTB_@cademy_student!`

You can also use these credentials to SSH into the target VM and configure OpenVAS.

---

## OpenVAS Scan

The OpenVAS Greenbone Security Assistant application has various tabs that you can interact with. For this section, we will be digging into the scans. If you navigate to the **Scans** tab, you will see the scans that have run in the past. You will also be able to see how to create a new task to run a scan. The tasks work off of the scanning configurations that the user sets up.

> **Note:** The scans shown in this section have already been pre-run to save you the time of waiting for them to finish. If you re-run the scan, itâ€™s best to go through vulnerabilities as they come instead of waiting for the scan to finish, as they can take 1-2 hours to complete.

### Configuration

Before setting up any scans, it is best to configure the targets for the scan. If you navigate to the **Configurations** tab and select **Targets**, you will see targets that have already been added to the application.

To add your own target, click the icon highlighted in the interface and add an individual target or a host list. You can also configure other options such as the ports, authentication, and methods of identifying if the host is reachable. For the **Alive Test**, the **Scan Config Default** option from OpenVAS leverages the NVT Ping Host in the NVT Family.

> **Credentials for Credentialed Scans:**
> - Linux: `htb-student_adm:HTB_@cademy_student!`
> - Windows: `administrator:Academy_VA_adm1!`

Once you have added your target, it will appear in the target list.

### Setting Up a Scan

OpenVAS provides various scan configurations leveraging Network Vulnerability Test (NVT) Families. These consist of many different categories of vulnerabilities, such as for Windows, Linux, Web Applications, etc. Recommended scan configurations include:

- **Base**: Enumerates host status and operating system information without checking for vulnerabilities.
- **Discovery**: Identifies services, hardware, accessible ports, and software but does not check for vulnerabilities.
- **Host Discovery**: Solely tests if the host is alive and determines active devices on the network using ping.
- **System Discovery**: Identifies the operating system and hardware associated with the host.
- **Full and fast**: Safest option recommended by OpenVAS, leveraging intelligent NVT checks based on accessible ports.

To create a scan, navigate to the **Scans** tab and click the wizard icon. This will bring up a configuration panel to set up your scan. For example:

- Target: `172.16.16.160`
- Configuration: **Linux Basic**

Once configured, run the scan. Depending on the settings, it may take 30-60 minutes to complete.

---

## Exporting the Results

OpenVAS provides the scan results in a report that can be accessed from the **Scans** page.

Once you click the report, you can view the scan results and gather details such as operating system information, open ports, services, etc., in other tabs within the scan report.

### Exporting Formats

Various export formats are available for reporting purposes, including:

- XML
- CSV
- PDF
- ITG
- TXT

If you choose to export your report in XML format, you can leverage various XML parsers to view the data in a more readable format.

### Using openvasreporting Tool

We will export our results in XML and use the `openvasreporting` tool by TheGroundZero. This tool provides various options for generating output. For this example, we will generate an Excel file.

```bash
python3 -m openvasreporting -i report-2bf466b5-627d-4659-bea6-1758b43235b1.xml -f xlsx
```

This command will generate an Excel document similar to the one shown below:

(Include screenshot or description of the generated Excel file here.)

---

## Additional Notes

- The VM provided for this challenge comes with OpenVAS pre-installed, and the targets are already running.
- Take time to explore the web interface to configure and run custom scans.
